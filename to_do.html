<!DOCTYPE html>
<html lang="en">

<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        #list_zone {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .checked {
            text-decoration: line-through;
        }
    </style>
</head>

<body>

    <div class="container p-4 my-5 bg-dark">
        <div class=" text-light container d-flex align-items-center justify-content-center">
            <h1 class="text-light">TO DO LİST</h1>
        </div>
    </div>
    <div class="container-fluid">
        <div class="col-4 ms-auto">
            <nav class="navbar navbar-expand-sm  bg-success ">
                <div class="ms-auto ">
                    <ul class="navbar-nav">
                        <li class="nav-item mx-5 ">
                            <a class="nav-link text-light" href="#" >HOME</a>
                        </li>
                        <li class="nav-item mx-5">
                            <a class="nav-link text-light" href="#">HOW</a>
                        </li>
                        <li class="nav-item mx-5">
                            <a class="nav-link text-light" href="#">MYLİST</a>
                        </li>
                    </ul>
                </div>
        </div>

        </nav>
    </div>
    <div class="container-fluid col-6 ">
        <div class="card mt-3">
            <div class="card-header d-flex justify-content-center">LİST</div>
            <div class="card-body d-flex justify-content-center">
                <form>
                    <div class="input-group">
                        <input type="text" id="inputText" class="form-control" placeholder="ENTER YOUR DUTİES">
                        <button type="submit" class="btn btn-primary" id="enter_button">ENTER</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="container-fluid col-6">
        <div class="card mt-3">
            <div id="list_zone">
                <button onclick="clearTasks()" type="button" class="btn btn-danger col-3"
                    id="clean_button">CLEAR</button>
            </div>
            <ul class="list-group " , id="duty_list">

            </ul>
        </div>
    </div>

    <script>
        let duty_list = [];
        if (localStorage.getItem("duty_list") !== null) {
            duty_list = JSON.parse(localStorage.getItem("duty_list"));

        }

        let text_input = document.querySelector("#inputText");

        let editId;
        let edit_mode = false;

        addTasks_list();
        function addTasks_list() {
            ul = document.getElementById("duty_list")
            ul.innerHTML = "";
            if (duty_list.length == 0) {
                ul.innerHTML = "<center><h5>let's make a to-do list</h5></center>"
            }
            else {
                for (let duty of duty_list) {
                    if (duty.situation == "checked") {
                        let li = `
                            <li class="list-group-item d-flex align-items-center justify-content-space-between">
                                    <input onclick="checkedTasks(this)" type="checkbox" id="${duty.id}" checked>
                                    <label for="${duty.id}" class="form-check-list checked" >${duty.name}</label> 
                                    <div class="ms-auto">
                                    <div class="dropdown">
                                    <button type="button" class="btn data-bs-toggle" data-bs-toggle="dropdown" >
                                        <i class="fa-solid fa-ellipsis"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a onclick='deleteTasks(${duty.id})' class="dropdown-item" href="#"><i class="fa-solid fa-trash"></i>delete</a></li>
                                        <li><a onclick='editTasks(${duty.id},"${duty.name}")' class="dropdown-item" href="#"><i class="fa-solid fa-pen-to-square"></i>edit</a></li>
                                    </ul>
                                    </div>
                                </div>
                            </li>
                            `;
                        ul.insertAdjacentHTML("beforeend", li);
                    }
                    else {
                        let li = `
                            <li class="list-group-item d-flex align-items-center justify-content-space-between">
                                    <input onclick="checkedTasks(this)" type="checkbox" id="${duty.id}">
                                    <label for="${duty.id}" class="form-check-list" >${duty.name}</label> 
                                    <div class="ms-auto">
                                    <div class="dropdown">
                                    <button type="button" class="btn data-bs-toggle" data-bs-toggle="dropdown" >
                                        <i class="fa-solid fa-ellipsis"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a onclick='deleteTasks(${duty.id})' class="dropdown-item" href="#"><i class="fa-solid fa-trash"></i>delete</a></li>
                                        <li><a onclick='editTasks(${duty.id},"${duty.name}")' class="dropdown-item" href="#"><i class="fa-solid fa-pen-to-square"></i>edit</a></li>
                                    </ul>
                                    </div>
                                </div>
                            </li>
                            `;
                        ul.insertAdjacentHTML("beforeend", li);
                    }

                }

            }
            localStorage.setItem("duty_list", JSON.stringify(duty_list));

        }

        function addTasks(event) {
            if (text_input.value == "") {
                alert("YOU MUST GİVE DUTY");
            }
            else {
                if (!edit_mode) {
                    duty_list.push({ "id": duty_list.length, "name": text_input.value, "situation": "" })
                }
                else {
                    editIndex = duty_list.findIndex(duty => duty.id == editId);
                    duty_list[editIndex].name = text_input.value;
                    edit_mode = false;

                }
                addTasks_list();
                text_input.value = "";
                localStorage.setItem("duty_list", JSON.stringify(duty_list));
            }

            event.preventDefault();
        }

        function clearTasks() {
            duty_list.splice(0, duty_list.length);
            addTasks_list();
            localStorage.setItem("duty_list", JSON.stringify(duty_list));

        }

        function editTasks(taskId, taskName) {
            editId = taskId;
            edit_mode = true;
            text_input.value = taskName;
            localStorage.setItem("duty_list", JSON.stringify(duty_list));

        }

        function deleteTasks(deleteId) {
            let deleteIndex;
            deleteIndex = duty_list.findIndex(duty => duty.id == deleteId);
            duty_list.splice(deleteIndex, 1);
            addTasks_list();
            localStorage.setItem("duty_list", JSON.stringify(duty_list));
        }

        function checkedTasks(checkedDuty) {
            let checkIndex;
            checkIndex = duty_list.findIndex(duty => duty.id == checkedDuty.id);
            let label = checkedDuty.nextElementSibling;
            if (checkedDuty.checked) {
                duty_list[checkIndex].situation = "checked";
            }
            else {
                duty_list[checkIndex].situation = "";

            }
            addTasks_list();
            localStorage.setItem("duty_list", JSON.stringify(duty_list));
        }

        let enter_button = document.querySelector("#enter_button");

        enter_button.addEventListener("click", addTasks);




    </script>
</body>

</html>